# 超市收银系统 (POS System)

## 项目简介

这是一个基于面向对象设计的小型超市收银系统，实现了两个核心功能：
- **处理销售 (Process Sale)**: 记录商品销售，更新库存，生成收据
- **处理退货 (Handle Returns)**: 处理商品退货，恢复库存，计算退款

## 项目结构

```
PoS_System/
├── domain/              # 领域模型层（实体类）
│   ├── __init__.py
│   ├── product.py       # 产品实体
│   ├── sale.py          # 销售实体
│   ├── sale_item.py     # 销售项实体
│   └── return_transaction.py  # 退货交易实体
├── service/             # 业务逻辑层（服务类）
│   ├── __init__.py
│   ├── inventory_service.py   # 库存管理服务
│   ├── sale_service.py        # 销售服务
│   └── return_service.py      # 退货服务
├── ui/                  # 用户界面层
│   ├── __init__.py
│   ├── pos_ui.py        # POS系统CLI界面
│   └── pos_gui.py       # POS系统GUI界面
├── main.py              # 主程序入口（CLI版本）
├── main_gui.py          # 主程序入口（GUI版本）
└── README.md            # 项目说明文档
```

## 系统架构

本系统采用**分层架构**设计：

1. **领域模型层 (Domain Layer)**
   - 包含所有业务实体类
   - 负责数据建模和业务规则

2. **业务逻辑层 (Service Layer)**
   - 包含所有业务服务类
   - 处理业务逻辑和流程控制

3. **用户界面层 (UI Layer)**
   - 负责用户交互
   - 调用服务层完成业务操作

## 核心功能

### 1. 处理销售 (Process Sale)

**用例描述：**
- 顾客带着商品到收银台
- 收银员使用POS系统记录每个购买的商品
- 系统显示运行总计和商品明细
- 顾客使用现金支付，系统验证并记录支付信息
- 系统更新库存
- 顾客收到系统生成的收据，然后带着商品离开

**实现功能：**
- 创建销售单
- 添加商品到销售单
- 实时计算总金额
- 处理支付（支持现金、刷卡、移动支付）
- 计算找零
- 更新库存
- 保存销售记录

### 2. 处理退货 (Handle Returns)

**用例描述：**
- 顾客带着商品到收银台退货
- 收银员使用POS系统记录每个退货的商品
- 系统计算退款金额
- 系统恢复库存
- 完成退货流程

**实现功能：**
- 创建退货单
- 关联原始销售单（可选）
- 添加退货商品
- 计算退款总额
- 恢复库存
- 保存退货记录

## 运行方式

### 环境要求
- Python 3.7+
- Tkinter（通常随Python一起安装）

### 运行步骤

#### 方式一：使用启动脚本（推荐）

1. 确保已安装Python 3.7或更高版本

2. 运行启动脚本：
```bash
python start.py
```

3. 在菜单中选择启动方式（GUI或CLI）

#### 方式二：直接启动图形界面

```bash
python main_gui.py
```

#### 方式三：直接启动命令行界面

```bash
python main.py
```

## 使用示例

### 处理销售示例

```
1. 选择菜单选项 "1. 处理销售"
2. 系统创建新的销售单
3. 输入商品ID和数量添加商品
4. 可以继续添加更多商品
5. 选择"完成销售"
6. 输入支付方式和支付金额
7. 系统显示找零并完成交易
```

### 处理退货示例

```
1. 选择菜单选项 "2. 处理退货"
2. 输入原始销售单ID（可选）
3. 系统创建新的退货单
4. 输入商品ID和退货数量
5. 可以继续添加更多退货商品
6. 选择"完成退货"
7. 确认后系统完成退货并恢复库存
```

## 设计特点

1. **面向对象设计**
   - 使用类和对象封装业务逻辑
   - 遵循单一职责原则
   - 良好的封装性和可扩展性

2. **分层架构**
   - 清晰的层次划分
   - 低耦合高内聚
   - 易于维护和测试

3. **领域驱动设计**
   - 实体类清晰表达业务概念
   - 服务类处理业务逻辑
   - UI层负责用户交互

## 扩展功能

系统还提供了以下辅助功能：
- 查看商品列表
- 查看销售历史
- 查看退货历史

## 界面说明

### GUI界面特点

- **现代化设计**: 使用Tkinter实现，界面美观易用
- **颜色区分**: 不同功能使用不同颜色标识（销售-绿色，退货-红色，商品-蓝色，历史-紫色）
- **实时更新**: 销售单和退货单实时显示，自动计算总金额
- **友好提示**: 操作成功/失败都有明确的提示信息
- **历史记录**: 支持查看销售历史和退货历史，使用标签页切换

### GUI功能模块

1. **处理销售窗口**
   - 商品选择下拉框
   - 数量输入
   - 实时显示销售单明细
   - 支付对话框（支持多种支付方式）
   - 自动计算找零

2. **处理退货窗口**
   - 可关联原始销售单
   - 退货商品选择
   - 实时显示退货单明细
   - 自动计算退款总额

3. **商品列表窗口**
   - 表格形式显示所有商品
   - 显示商品ID、名称、单价、库存

4. **历史记录窗口**
   - 标签页切换销售历史和退货历史
   - 详细显示每笔交易的详细信息

## 开发说明

本项目是软件工程实践作业，展示了：
- 用例模型设计
- 领域模型设计（UML类图）
- 系统逻辑架构设计（分层架构）
- 面向对象设计和实现
- 敏捷开发方法（Scrum）

## 作者

开发团队

## 许可证

本项目仅用于教学目的

